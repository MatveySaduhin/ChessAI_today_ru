### Ульяновский Государственный Университет
Факультет Математики, Информационных и Авиационных технологий
Садюхин Матвей ПРИ-О-22/1 

# Искусственный интеллект в шахматах сегодня: от перебора к интуиции

Сегодняшний ландшафт шахматного ИИ кардинально отличается от того, что был во времена победы Deep Blue над Гарри Каспаровым. Произошёл фундаментальный сдвиг от **«классического» ИИ**, основанного на грубой силе перебора, к **нейросетевому подходу**, который можно сравнить с интуицией.

---

### Два лагеря современных движков

Все современные топ-движки можно условно разделить на две категории, которые и определяют их сильные и слабые стороны.

#### 1. «Чистые» нейросетевые движки (AlphaZero, Leela Chess Zero)
Эти движки стали революцией, представленной DeepMind в 2017 году. Их архитектура fundamentally отличается от классических программ.

* **Как они работают:**
    * **Обучение с подкреплением:** Они учатся, играя миллионы партий сами с собой, не имея никаких человеческих знаний, кроме правил игры. Этот процесс называется обучением «с нуля» (Tabula Rasa).
    * **Нейронная сеть:** В их основе лежит глубокая нейронная сеть, которая выполняет две функции:
        1.  **Оценка позиции:** Вместо сотен правил, написанных программистами, нейросеть сама вырабатывает критерии оценки, находя неочевидные позиционные нюансы.
        2.  **Выбор хода:** Сеть также предсказывает, какие ходы наиболее перспективны в данной позиции.
    * **Поиск по дереву Монте-Карло (MCTS):** Вместо того чтобы просчитывать все возможные ходы (как в альфа-бета переборе), MCTS использует предсказания нейросети, чтобы «умнее» и глубже исследовать наиболее обещающие варианты.

* **Преимущества:**
    * **Позиционное понимание:** Играют в более «человеческом», интуитивном стиле. Они прекрасно понимают долгосрочные стратегические концепции, могут идти на материальные жертвы ради инициативы и находить нешаблонные идеи.
    * **Креативность:** Способны генерировать абсолютно новые дебютные идеи, которые изменили современную теорию.
    * **Самообучение:** Не требуют кропотливой ручной настройки сотен параметров.

* **Недостатки:**
    * **Требовательность к ресурсам:** Для эффективной работы требуют мощных видеокарт (GPU). На обычных процессорах (CPU) их производительность значительно ниже.
    * **Тактические «промахи»:** Иногда могут упускать из виду форсированные тактические варианты, которые классический движок нашёл бы мгновенно, так как их поиск менее широк.
    * **Эффект «стада»:** MCTS может сконцентрироваться на одном «интересном» варианте и упустить простой выигрыш в другой ветке.

---

#### 2. Гибридные движки (Современный Stockfish)
После успеха AlphaZero казалось, что классический подход мёртв. Однако разработчики Stockfish совершили контрреволюцию, создав гибрид.

* **Как они работают:**
    * **Классический поиск:** Stockfish по-прежнему использует свой непревзойдённый по скорости и эффективности **альфа-бета поиск**, который работает на CPU. Он перебирает миллиарды позиций в секунду.
    * **Нейросетевая оценка (NNUE):** Вместо старой оценочной функции, написанной вручную, Stockfish теперь использует специально обученную, легковесную нейронную сеть (Efficiently Updatable Neural Network). Эта сеть оценивает позицию, но делает это гораздо быстрее, чем глубокие сети в Leela Chess Zero.

* **Преимущества:**
    * **Синергия:** Сочетают лучшее из двух миров: тактическую зоркость и скорость альфа-бета поиска с тонким позиционным пониманием нейросетевой оценки.
    * **Эффективность на CPU:** Являются абсолютными лидерами на стандартном «железе» без мощных видеокарт.
    * **Тактическая безупречность:** Практически не допускают тактических ошибок благодаря огромной ширине поиска.

* **Недостатки:**
    * **Меньшая «креативность»:** Реже находят совершенно новые стратегические концепции по сравнению с Leela, так как их поиск всё ещё более «прямолинеен».
    * **Зависимость от архитектуры сети:** Качество игры сильно зависит от архитектуры и качества обучения NNUE-сети.

---

### Технологии и команды за кулисами

Успех современных движков обеспечивается конкретными технологическими решениями и работой больших команд.

#### Google DeepMind и архитектура AlphaZero

* **Команда:** Проект AlphaZero был разработан исследовательской лабораторией **Google DeepMind** в Великобритании, известной своими прорывами в области ИИ. Их работа носила фундаментальный научный характер и не была направлена на создание коммерческого шахматного продукта.
* **Технология:** Архитектура AlphaZero основана на глубоких **свёрточных нейронных сетях (Convolutional Neural Networks, CNN)**.
    * **Входные данные:** На вход сеть получает "стопку" изображений (матриц), представляющих позицию: расположение своих фигур, чужих фигур, историю ходов и другие игровые параметры.
    * **"Тело" сети:** Состоит из множества блоков **остаточных сетей (Residual Networks, ResNet)**. Эта архитектура позволяет создавать очень глубокие нейросети, которые эффективно обучаются, избегая проблемы затухания градиента.
    * **Две "головы":** После обработки в "теле" ResNet, данные поступают на два выхода:
        1.  **Value Head (Оценочная голова):** Выдаёт одно число — оценку позиции с точки зрения вероятности победы из текущего положения.
        2.  **Policy Head (Политическая голова):** Выдаёт вероятностное распределение для всех возможных ходов, показывая, какие из них сеть считает наиболее перспективными.
    * **Обучение:** Весь процесс обучения — это замкнутый цикл. Движок играет сам с собой, используя MCTS. Итоги партий (победа/поражение) используются для корректировки весов *Value Head*, а статистика MCTS (какие ходы чаще приводили к успеху) — для обучения *Policy Head*.

#### Leela Chess Zero и сила Open Source

* **Команда:** Lc0 — это не коммерческий проект, а результат работы **международного open-source сообщества**. Ключевую роль сыграл программист **Гэри Линскотт** (один из разработчиков Stockfish), который инициировал проект. Тысячи волонтёров по всему миру предоставляют мощности своих компьютеров (в основном GPU) для распределенного обучения нейронной сети.
* **Технология:** Lc0 является открытой реализацией идей AlphaZero. Архитектура сети очень похожа: свёрточные слои, ResNet-блоки и две "головы" (Value и Policy). Главное отличие — в открытости процесса. Любой желающий может:
    * Наблюдать за процессом обучения в реальном времени.
    * Скачать любую версию нейросети (называемую "net").
    * Предложить свои улучшения в код движка или процесс обучения.

#### Stockfish и прагматичная революция NNUE

* **Команда:** Stockfish разрабатывается и поддерживается большим и опытным **сообществом разработчиков**. Внедрение NNUE стало возможным благодаря работе японских программистов, изначально применивших эту технологию в сёги (японских шахматах). Их наработки были адаптированы и интегрированы в Stockfish.
* **Технология (NNUE - Efficiently Updatable Neural Network):** Это совершенно иной подход, созданный для максимальной скорости на **CPU**.
    * **Архитектура:** NNUE — это не глубокая, а **неглубокая (shallow) нейронная сеть**. Обычно она состоит всего из 4-5 слоёв, в основном **полносвязных (Fully Connected layers)**.
    * **Входные данные:** Вместо "картинки" доски, NNUE использует разреженное (sparse) представление. Ключевая идея — **HalfKP**. Позиция кодируется с точки зрения положения короля каждой из сторон. Для каждого из 64 полей, где может стоять белый король, и для каждого из 64 полей для черного короля, создается уникальный набор входных нейронов, активируемых наличием той или иной фигуры на доске.
    * **Эффективное обновление:** Главный секрет скорости. Когда делается ход, на доске меняется положение всего одной-двух фигур. Благодаря архитектуре HalfKP, движку не нужно пересчитывать всю сеть заново. Он лишь деактивирует нейроны, связанные со старым положением фигуры, и активирует новые. Это позволяет вычислять оценку с минимальными затратами, достигая сотен тысяч и миллионов оценок в секунду на одном ядре CPU.
    * **Обучение:** Сети для NNUE, как правило, обучаются методом **контролируемого обучения (Supervised Learning)**. Берутся миллионы позиций из партий сильных движков (включая сам Stockfish и Lc0), и сеть обучается предсказывать уже готовую оценку или результат партии для этих позиций.

---

### Статистическое подтверждение доминирования

Успех нейросетевых и гибридных подходов наглядно демонстрируют результаты **Top Chess Engine Championship (TCEC)** — самого престижного чемпионата среди шахматных программ.

#### Результаты суперфиналов TCEC (Сезоны 14-25)

| Сезон | Победитель | Финалист | Счёт (Победы-Ничьи-Поражения) |
| :--- | :--- | :--- | :--- |
| **14** | Stockfish (Классика) | Lc0 (Нейросеть) | +5 =90 -5 |
| **15** | Lc0 (Нейросеть) | Stockfish (Классика) | +14 =79 -7 |
| **16** | Stockfish (Классика) | AllieStein (Нейросеть) | +14 =81 -5 |
| **17** | Lc0 (Нейросеть) | Stockfish (Классика) | +17 =71 -12 |
| **18** | Stockfish (**Гибрид NNUE**) | Lc0 (Нейросеть) | +23 =61 -16 |
| **19** | Stockfish (Гибрид NNUE) | Lc0 (Нейросеть) | +18 =73 -9 |
| **20** | Stockfish (Гибрид NNUE) | Lc0 (Нейросеть) | +14 =78 -8 |
| **21** | Stockfish (Гибрид NNUE) | Lc0 (Нейросеть) | +19 =74 -7 |
| **22** | Stockfish (Гибрид NNUE) | KomodoDragon (Гибрид) | +28 =63 -9 |
| **23** | Stockfish (Гибрид NNUE) | Lc0 (Нейросеть) | +27 =63 -10 |
| **24** | Stockfish (Гибрид NNUE) | Lc0 (Нейросеть) | +20 =64 -16 |
| **25** | Stockfish (Гибрид NNUE) | Lc0 (Нейросеть) | +27 =50 -23 |

*Источник: Wikipedia, TCEC Results.*

---

### Заключение: будущее за синтезом

Современное состояние ИИ в шахматах — это триумф нейронных сетей. Они либо полностью определяют игру движка (Leela Chess Zero), либо, как в случае с NNUE, являются ключевым компонентом его оценки. Классический подход, основанный исключительно на человеческих эвристиках, ушёл в прошлое. Будущее, вероятно, лежит в дальнейшем углублении синтеза сверхбыстрых алгоритмов поиска и всё более совершенных нейросетевых архитектур, которые будут открывать новые, ещё более глубокие горизонты в древней игре.

